<div class="my-orders-container">
  <h2>Dostupna Hrana</h2>

  <div *ngIf="foods.length === 0">
    Nema dostupnih stavki hrane.
  </div>

  <table *ngIf="foods.length > 0" class="table">
    <thead>
      <tr>
        <th>Slika</th>
        <th>Naziv</th>
        <th>Tip 1</th>
        <th>Tip 2</th>
        <th>Ocena</th>
        <th>Akcije</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let food of foods">
        <td class="img-col" (click)="openDetails(food.id!)" style="cursor:pointer">
          <img class="food-thumb" [src]="getImageSrc(food)" alt="Slika hrane" />
        </td>

        <td (click)="openDetails(food.id!)" style="cursor:pointer">
          {{ food.foodName }}
        </td>

        <td>{{ mapType1(food.type1) }}</td>
        <td>{{ mapType2(food.type2) }}</td>

        <!-- AVG stars read-only -->
        <td>
          <div class="stars-row">
            <span class="stars-label">
              {{ (summaries[food.id!]?.avgRating || 0) | number:'1.1-1' }}
              ({{ summaries[food.id!]?.ratingCount || 0 }})
            </span>

            <div class="stars read-only" aria-label="Prosečna ocena">
              <span
                *ngFor="let s of [1,2,3,4,5]; let i = index"
                class="star"
              >
                <span class="star-empty">★</span>
                <span
                  class="star-fill"
                  [style.width.%]="getStarFillPercent((summaries[food.id!]?.avgRating || 0), i)"
                >★</span>
              </span>
            </div>
          </div>
        </td>

        <td>
          <button class="btn-action" (click)="deleteFood(food.id!)">Delete</button>
          <button class="btn-action" (click)="goToUpdate(food.id!)">Update</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
